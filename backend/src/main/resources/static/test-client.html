<!DOCTYPE html>
<html>
<body>
<script src="https://cdn.jsdelivr.net/npm/sockjs-client@1.5.0/dist/sockjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<script>
    const socket = new SockJS('http://localhost:8080/ws');
    const stompClient = Stomp.over(socket);

    stompClient.connect({}, function(frame) {
        console.log('Connected: ' + frame);

        stompClient.subscribe('/topic/tasks', function(message) {
            console.log('Received:', JSON.parse(message.body));
        });
    });

    // Test after 2 seconds
    setTimeout(() => {
        fetch('http://localhost:8080/api/tasks', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                title: "Test Task",
                description: "WebSocket Test",
                status: "TODO",
                priority: "HIGH"
            })
        });
    }, 2000);
</script>
</body>
</html>